$OpenBSD$
--- nsprpub/pr/src/misc/prnetdb.c.orig	2004-01-22 15:22:37.000000000 -0700
+++ nsprpub/pr/src/misc/prnetdb.c	2004-10-03 05:27:25.000000000 -0600
@@ -2094,7 +2094,12 @@ PR_IMPLEMENT(PRAddrInfo *) PR_GetAddrInf
          */
         hints.ai_socktype = SOCK_STREAM;
 
+	LOCK_DNS();
+
         rv = GETADDRINFO(hostname, NULL, &hints, &res);
+
+	UNLOCK_DNS();
+
         if (rv == 0)
             return (PRAddrInfo *) res;
 
